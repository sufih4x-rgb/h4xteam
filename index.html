<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Login â€¢ H4XTEAM</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="global.css">

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-auth.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-database.js"></script>

</head>
<body>

<div class="box">
    <h2>LOGIN</h2>

    <input type="email" id="email" placeholder="Email">
    <input type="password" id="password" placeholder="Password">

    <button onclick="login()">LOGIN</button>

    <br><br>
    <span class="link" onclick="location='register.html'">Create Account</span><br>
    <span class="link" onclick="location='reset.html'">Forgot Password?</span>
</div>

<script>
// ---------------- FIREBASE SETUP ----------------
const firebaseConfig = {
    apiKey: "AIzaSyAzfvbiqRqsQwBOOIkegxJD09di-S_tfHg",
    authDomain: "test-eb5e7.firebaseapp.com",
    databaseURL: "https://test-eb5e7-default-rtdb.firebaseio.com",
    projectId: "test-eb5e7",
    storageBucket: "test-eb5e7.appspot.com",
    messagingSenderId: "366282855653",
    appId: "1:366282855653:web:dca7e000f5a22fb11f300c",
    measurementId: "G-ECKCTBLQJ8"
};
firebase.initializeApp(firebaseConfig);

const auth = firebase.auth();
const db = firebase.database();

// ---------------- LOGIN FUNCTION ----------------
function login() {
    let email = document.getElementById("email").value.trim();
    let pass = document.getElementById("password").value.trim();

    if (!email || !pass) return alert("All fields required");

    auth.signInWithEmailAndPassword(email, pass)
    .then(user => {
        let uid = user.user.uid;

        // Log IP
        fetch("https://api.ipify.org?format=json")
        .then(r => r.json())
        .then(ip => {
            db.ref("ipLogs/" + uid).set({
                ip: ip.ip,
                timestamp: new Date().toLocaleString()
            });
        });

        location = "dashboard.html";
    })
    .catch(err => alert(err.message));
}
</script>

</body>
</html>
