<!DOCTYPE html>
<html>
<head>
<title>Game - H4XTEAM</title>
<style>
body{background:#000;color:#0affff;font-family:Arial;text-align:center;padding-top:30px}
button{padding:15px;width:40%;margin:10px;font-size:18px;border:none;border-radius:8px;font-weight:bold;cursor:pointer}
.red{background:#ff0033;color:#fff;box-shadow:0 0 12px #ff0033}
.green{background:#00ff55;color:#000;box-shadow:0 0 12px #00ff55}
input{width:80%;padding:12px;margin-top:20px;background:#111;border:1px solid #0affff;color:#0affff;border-radius:8px}
#box{padding:20px;border:1px solid #0affff;margin:20px;border-radius:8px}
.back{width:80%;background:#0affff;color:#000;margin-top:20px}
</style>
</head>
<body>

<h1>Red / Green Game</h1>

<div id="box">
  <p>Balance: ₹<span id="balance">0</span></p>
  <input id="bet" type="number" placeholder="Enter Bet Amount (min 5)">
</div>

<button class="red" onclick="play('red')">RED</button>
<button class="green" onclick="play('green')">GREEN</button>

<button class="back" onclick="window.location='dashboard.html'">Back</button>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
import { getAuth, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";
import { getDatabase, ref, get, update } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";

const firebaseConfig={
 apiKey:"AIzaSyAzfvbiqRqsQwBOOIkegxJD09di-S_tfHg",
 authDomain:"test-eb5e7.firebaseapp.com",
 databaseURL:"https://test-eb5e7-default-rtdb.firebaseio.com",
 projectId:"test-eb5e7",
 storageBucket:"test-eb5e7.appspot.com",
 messagingSenderId:"366282855653",
 appId:"1:366282855653:web:dca7e000f5a22fb11f300c",
 measurementId:"G-ECKCTBLQJ8"
};

const app=initializeApp(firebaseConfig);
const auth=getAuth(app);
const db=getDatabase(app);

let uid="";
let balance=0;

onAuthStateChanged(auth, async user=>{
 if(!user) return window.location="index.html";
 uid=user.uid;
 let snap = await get(ref(db,"users/"+uid));
 balance = snap.val().balance;
 document.getElementById("balance").innerText = balance;
});

window.play = async function(color){
 let bet = Number(document.getElementById("bet").value);

 if(bet < 5){ alert("Minimum bet is 5"); return; }
 if(bet > balance){ alert("Not enough balance"); return; }

 let result = Math.random() < 0.5 ? "red" : "green";

 let winAmount = 0;
 if(result === color){
   winAmount = bet * 1.9; // payout 1.9x
   balance += winAmount;
   alert("You WON! Result = " + result + "\nYou got ₹" + winAmount);
 } else {
   balance -= bet;
   alert("You LOST. Result = " + result);
 }

 await update(ref(db,"users/"+uid),{ balance: balance });

 document.getElementById("balance").innerText = balance;
}
</script>

</body>
</html>
