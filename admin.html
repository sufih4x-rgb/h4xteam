<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Admin Panel â€“ H4X TEAM</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
    body {
        font-family: Arial, sans-serif;
        background:#0d0d0d;
        color:white;
        margin:0;
        padding:0;
    }
    .container {
        width:95%;
        margin:auto;
        padding:20px;
    }
    h1 { color:#00ff9d; text-align:center; }
    .box {
        background:#111;
        padding:15px;
        border-radius:10px;
        margin-top:20px;
        border:1px solid #00ff9d;
    }
    input, button {
        width:100%;
        padding:10px;
        margin:5px 0;
        border-radius:6px;
        border:none;
    }
    input {
        background:#222;
        color:#fff;
        border:1px solid #00ff9d;
    }
    button {
        background:#00ff9d;
        color:black;
        font-weight:bold;
    }
    .item {
        background:#1a1a1a;
        padding:10px;
        border-radius:8px;
        margin:7px 0;
        border:1px solid #00ff9d50;
    }
</style>
</head>
<body>

<div class="container">

    <h1>H4XTEAM ADMIN PANEL</h1>

    <!-- LOGIN BOX -->
    <div id="loginBox" class="box">
        <h2>Admin Login</h2>
        <input id="adminUser" placeholder="Admin Username">
        <input id="adminPass" type="password" placeholder="Admin Password">
        <button onclick="adminLogin()">LOGIN</button>
    </div>

    <!-- DASHBOARD -->
    <div id="dashboard" class="box" style="display:none;">
        <h2>Dashboard</h2>
        <button onclick="loadDeposits()">Pending Deposits</button>
        <button onclick="loadWithdraws()">Pending Withdrawals</button>
        <button onclick="loadUsers()">All Users</button>
    </div>

    <!-- DISPLAY AREA -->
    <div id="output" class="box" style="display:none;">
        <h2 id="title"></h2>
        <div id="list"></div>
    </div>

</div>

<!-- FIREBASE -->
<script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js"></script>

<script>
    // ðŸ”¥ YOUR FIREBASE CONFIG â€” REPLACE WITH YOURS
    const firebaseConfig = {
      apiKey: "AIzaSyAzfvbiqRqsQwBOOIkegxJD09di-S_tfHg",
      authDomain: "test-eb5e7.firebaseapp.com",
      databaseURL: "https://test-eb5e7-default-rtdb.firebaseio.com",
      projectId: "test-eb5e7",
      storageBucket: "test-eb5e7.appspot.com",
      messagingSenderId: "366282855653",
      appId: "1:366282855653:web:dca7e000f5a22fb11f300c",
      measurementId: "G-ECKCTBLQJ8"
    };
    
    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    // ðŸ” FIXED ADMIN LOGIN
    const ADMIN_USER = "H4XTEAMADMIN";
    const ADMIN_PASS = "OK SEND";

    function adminLogin() {
        let u = adminUser.value;
        let p = adminPass.value;

        if (u === ADMIN_USER && p === ADMIN_PASS) {
            loginBox.style.display = "none";
            dashboard.style.display = "block";
        } else {
            alert("Wrong Admin Login!");
        }
    }

    function loadDeposits() {
        title.innerText = "Pending Deposits";
        output.style.display = "block";
        list.innerHTML = "";

        db.ref("deposits").orderByChild("status").equalTo("pending").once("value", snap => {
            if (!snap.exists()) {
                list.innerHTML = "<p>No Pending Deposits</p>";
                return;
            }

            snap.forEach(d => {
                let data = d.val();
                list.innerHTML += `
                <div class="item">
                    <p><b>User:</b> ${data.userId}</p>
                    <p><b>Amount:</b> â‚¹${data.amount}</p>
                    <p><b>UTR:</b> ${data.utr}</p>
                    <button onclick="approveDeposit('${d.key}', '${data.userId}', ${data.amount})">APPROVE</button>
                    <button onclick="rejectDeposit('${d.key}')">REJECT</button>
                </div>`;
            });
        });
    }

    function approveDeposit(id, userId, amount) {
        db.ref("users/" + userId + "/balance").transaction(bal => (bal || 0) + amount);
        db.ref("deposits/" + id + "/status").set("approved");
        alert("Deposit Approved");
        loadDeposits();
    }

    function rejectDeposit(id) {
        db.ref("deposits/" + id + "/status").set("rejected");
        alert("Deposit Rejected");
        loadDeposits();
    }

    function loadWithdraws() {
        title.innerText = "Pending Withdrawals";
        output.style.display = "block";
        list.innerHTML = "";

        db.ref("withdraws").orderByChild("status").equalTo("pending").once("value", snap => {
            if (!snap.exists()) {
                list.innerHTML = "<p>No Pending Withdrawals</p>";
                return;
            }

            snap.forEach(w => {
                let data = w.val();
                list.innerHTML += `
                <div class="item">
                    <p><b>User:</b> ${data.userId}</p>
                    <p><b>Amount:</b> â‚¹${data.amount}</p>
                    <button onclick="approveWithdraw('${w.key}', '${data.userId}', ${data.amount})">APPROVE</button>
                    <button onclick="rejectWithdraw('${w.key}')">REJECT</button>
                </div>`;
            });
        });
    }

    function approveWithdraw(id, userId, amount) {
        db.ref("users/" + userId + "/balance").transaction(bal => {
            if ((bal || 0) >= amount) return bal - amount;
            return bal;
        });

        db.ref("withdraws/" + id + "/status").set("approved");
        alert("Withdrawal Approved");
        loadWithdraws();
    }

    function rejectWithdraw(id) {
        db.ref("withdraws/" + id + "/status").set("rejected");
        alert("Withdrawal Rejected");
        loadWithdraws();
    }

    function loadUsers() {
        title.innerText = "Users";
        output.style.display = "block";
        list.innerHTML = "";

        db.ref("users").once("value", snap => {
            snap.forEach(u => {
                let data = u.val();
                list.innerHTML += `
                <div class="item">
                    <p><b>ID:</b> ${u.key}</p>
                    <p><b>Name:</b> ${data.name || "N/A"}</p>
                    <p><b>Balance:</b> â‚¹${data.balance || 0}</p>
                </div>`;
            });
        });
    }
</script>

</body>
</html>
